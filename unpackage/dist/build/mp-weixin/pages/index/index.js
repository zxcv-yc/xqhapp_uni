(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"347c":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=s(n("f991")),i=s(n("b057"));function s(t){return t&&t.__esModule?t:{default:t}}var a={data:function(){return{status:"loadmore",iconType:"flower",loadText:{loadmore:"上拉加载更多",loading:"努力加载中",nomore:"没有更多了"},swiperList:null,sortId:"all",imgUrl:o.default.imgUrl,dotStyle:1,menuList:[],address:"",amapPlugin:null,screenIndex:1,key:"6357e894cdbb23207ebbd23dc821232b",posName:t.getStorageSync("posName"),lat:t.getStorageSync("lat"),lng:t.getStorageSync("lng"),pageNum:1,shopList:[],star:"",priceSort:"",cate_id:"",sell_num:"",nearMe:"",list_tag:""}},onLoad:function(){t.showLoading({title:"加载中"}),this.amapPlugin=new i.default.AMapWX({key:this.key})},onShow:function(){this.allRequest()},onReady:function(){t.hideLoading()},onPullDownRefresh:function(){console.log("触发下拉刷新"),this.posName=t.getStorageSync("posName"),this.lat=t.getStorageSync("lat"),this.lng=t.getStorageSync("lng"),this.shopList=[],this.allRequest(),t.stopPullDownRefresh()},onReachBottom:function(){++this.pageNum,this.getShop(),console.log("触发上拉")},methods:{allRequest:function(){console.log(this.lat),console.log(this.lng),console.log(this.posName),(""==this.lat||this.lat.length<1||""==this.lng||""==this.posName)&&(console.log("zhixingdingwei"),this.getRegeo()),this.lat=t.getStorageSync("lat"),this.lng=t.getStorageSync("lng"),this.posName=t.getStorageSync("posName"),this.getBanner(),this.getNavigatorMenu(),this.getShop()},getRegeo:function(){var e=this;this.amapPlugin.getRegeo({success:function(n){console.log(n),e.cityName=n[0].regeocodeData.addressComponent.city,t.setStorageSync("lat",n[0].latitude),t.setStorageSync("lng",n[0].longitude),t.setStorageSync("posName",n[0].regeocodeData.addressComponent.city)}})},maskClick:function(){console.log("masins"),this.sortShow=!1,console.log(this.sortShow)},goSearch:function(){},chooseSortType:function(t){switch(this.sortId=t.currentTarget.dataset.id,this.star="",this.priceSort="",this.nearMe="",this.sell_num="",this.pageNum=1,this.list_tag="",t.currentTarget.dataset.id){case"star":this.star=1;break;case"price1":this.list_tag=1,this.priceSort=1;break;case"price2":this.list_tag=1,this.priceSort=2;break}this.getShop(),this.sortShow=!1},getBanner:function(){var t=this,e={url:"index/getBanner",method:"post"},n={city_id:"370700",cate_id:"1"};o.default.httpTokenRequest(e,n).then((function(e){var n=e.data.data;for(var o in n)n[o].image=t.imgUrl+n[o].pic;t.swiperList=n,console.log(t.swiperList)}),(function(t){console.log(t)}))},getNavigatorMenu:function(){var t=this,e={url:"index/getNavigator",method:"post"},n={city_id:"370700"};o.default.httpTokenRequest(e,n).then((function(e){for(var n=e.data.data,o=[],i=0;i<n.length;i+=10)o.push(n.slice(i,i+10));t.menuList=o}),(function(t){console.log(t)}))},clickScreen:function(e){this.screenIndex=e.target.id,t.createSelectorQuery().select(".screen_box").boundingClientRect((function(e){t.createSelectorQuery().select(".container").boundingClientRect((function(n){t.pageScrollTo({duration:0,scrollTop:e.top-n.top})})).exec()})).exec(),1==e.target.id?this.sortShow=!0:this.sortShow=!1,2!=e.target.id&&3!=e.target.id||(this.star="",this.priceSort="",this.nearMe="",this.sell_num="",this.pageNum=1,this.list_tag="",2==e.target.id?(this.nearMe=1,this.list_tag=1):3==e.target.id&&(this.sell_num=1),this.getShop()),console.log("dianji")},getShop:function(){var t=this;this.status="loading";var e={url:"index/shop",method:"post"},n={pageNum:this.pageNum,city_id:370700,lat:this.lat,lng:this.lng,star:this.star,priceSort:this.priceSort,nearMe:this.nearMe,sell_num:this.sell_num,list_tag:this.list_tag};console.log(n),o.default.httpTokenRequest(e,n).then((function(e){1==t.pageNum&&(t.shopList=[]),t.shopList=t.shopList.concat(e.data.data),t.status=e.data.data.length?"loadmore":"nomore",console.log(t.shopList)}),(function(t){console.log(t)}))},goNear:function(){t.navigateTo({url:"near"})},goShop:function(e){t.navigateTo({url:"../shop/shop?shop_id="+e})},moveHandle:function(){}}};e.default=a}).call(this,n("543d")["default"])},4292:function(t,e,n){"use strict";(function(t){n("0bf5"),n("921b");o(n("66fd"));var e=o(n("5546"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},5546:function(t,e,n){"use strict";n.r(e);var o=n("e8d4"),i=n("f8d2");for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("6f70");var a,r=n("f0c5"),u=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],a);e["default"]=u.exports},"6f70":function(t,e,n){"use strict";var o=n("feb8"),i=n.n(o);i.a},e8d4:function(t,e,n){"use strict";var o={"u-icon":function(){return n.e("uview-ui/components/u-icon/u-icon").then(n.bind(null,"c80c"))},"u-swiper":function(){return n.e("uview-ui/components/u-swiper/u-swiper").then(n.bind(null,"e38e"))},"u-sticky":function(){return n.e("uview-ui/components/u-sticky/u-sticky").then(n.bind(null,"7ac5"))},"u-rate":function(){return n.e("uview-ui/components/u-rate/u-rate").then(n.bind(null,"d48b"))},"u-tag":function(){return n.e("uview-ui/components/u-tag/u-tag").then(n.bind(null,"5de4"))},"u-loadmore":function(){return n.e("uview-ui/components/u-loadmore/u-loadmore").then(n.bind(null,"cdd2"))}},i=function(){var t=this,e=t.$createElement;t._self._c},s=[];n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return o}))},f8d2:function(t,e,n){"use strict";n.r(e);var o=n("347c"),i=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(e,t,(function(){return o[t]}))}(s);e["default"]=i.a},feb8:function(t,e,n){}},[["4292","common/runtime","common/vendor"]]]);